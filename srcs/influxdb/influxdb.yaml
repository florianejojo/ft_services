apiVersion: v1
kind: Service
metadata:
  name: influxdb-service
  labels:
    app: influxdb
spec:
  selector:
    app: influxdb
  ports:
    - name: influxdb-port
      port: 8086
      targetPort: 8086
      protocol: TCP
  type: ClusterIP

---

apiVersion: apps/v1
kind: Deployment
metadata:
  name: influxdb-deployment
  # namespace: influxdb-deployment
  # annotations:
  # creationTimestamp: null
  # generation: 1
  # labels:
  #   app: influxdb
  # name: influxdb
spec:
  # progressDeadlineSeconds: 600
  # replicas: 1
  # revisionHistoryLimit: 10
  selector:
    matchLabels:
      app: influxdb
  replicas: 1
  template:
    metadata:
      labels:
        app: influxdb
    spec:
      restartPolicy: Always
      containers:
      - name: influxdb-service
        image: my-image-influxdb
        imagePullPolicy: Never
        ports:
        - containerPort: 8086
  # strategy:
  #   rollingUpdate:
  #     maxSurge: 25%
  #     maxUnavailable: 25%
  #   type: RollingUpdate
  # template:
  #   metadata:
  #     creationTimestamp: null
  #     labels:
  #       app: influxdb
  #   spec:
  #     containers:
  #     - envFrom:
  #       - secretRef:
  #           name: influxdb-secret
  #       image: my-image-influxdb
  #       imagePullPolicy: IfNotPresent
  #       name: influxdb-service
  #       ports:
  #         - containerPort: 8086
  #       resources: {}
  #       terminationMessagePath: /dev/termination-log
  #       terminationMessagePolicy: File
  #       volumeMounts:
  #       - mountPath: /var/lib/influxdb
  #         name: var-lib-influxdb
  #     dnsPolicy: ClusterFirst
  #     restartPolicy: Always
  #     schedulerName: default-scheduler
  #     securityContext: {}
  #     terminationGracePeriodSeconds: 30
  #     volumes:
  #     - name: var-lib-influxdb
  #       persistentVolumeClaim:
  #         claimName: influxdb-pvc

---

  apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  labels:
    app: influxdb
  name: influxdb-pvc
spec:
  accessModes:
    - ReadWriteOnce
  volumeMode: Filesyste
  resources:
    requests:
      storage: 1Gi
